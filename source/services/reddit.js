/**
 * Reddit service provider
 * Share doc: https://www.reddit.com/dev/api#POST_api_submit + https://stackoverflow.com/a/32533431
 * Counter doc: https://www.reddit.com/dev/api/#GET_search
 * Scores are in `child.data.score` and are number of up-votes minus number of down-votes for an URL submitted to Reddit
 * Displayed counter is calculated as sum of counts for the 5 most upvoted posts for this url.
 */
export default {
    name: 'reddit',
    counterUrl: 'https://www.reddit.com/search.json?q=url:{url}&sort=top&type=link&limit=5',
    convertNumber: (response) => {
        const parsedResponse = JSON.parse(response);
        let totalUpvotes = 0;
        parsedResponse.data.children.forEach((child) => {
            if (child.data && child.data.score) {
                totalUpvotes += child.data.score;
            }
        });
        return totalUpvotes;
    },
    popupUrl: 'https://reddit.com/submit?url={url}&title={title}',
    popupWidth: 785,
    popupHeight: 550,
    knownParams: ['url', 'title', 'counter'],
    svgIconPath: 'M 13.667969 5.394531 C 13.132812 5.394531 12.644531 5.574219 12.253906 5.875 C 11.175781 5.21875 9.828125 4.800781 8.347656 4.742188 L 8.347656 4.734375 C 8.347656 3.742188 9.078125 2.917969 10.035156 2.785156 C 10.210938 3.519531 10.871094 4.066406 11.660156 4.066406 C 12.578125 4.066406 13.328125 3.320312 13.328125 2.402344 C 13.328125 1.476562 12.578125 0.734375 11.660156 0.734375 C 10.851562 0.734375 10.1875 1.300781 10.027344 2.058594 C 8.679688 2.210938 7.628906 3.351562 7.628906 4.734375 L 7.628906 4.742188 C 6.164062 4.800781 4.824219 5.226562 3.765625 5.882812 C 3.363281 5.574219 2.875 5.390625 2.339844 5.390625 C 1.050781 5.394531 0 6.433594 0 7.726562 C 0 8.667969 0.550781 9.464844 1.347656 9.839844 C 1.425781 12.546875 4.371094 14.730469 8.011719 14.730469 C 11.644531 14.730469 14.601562 12.546875 14.667969 9.832031 C 15.457031 9.464844 16 8.65625 16 7.726562 C 16 6.441406 14.957031 5.394531 13.667969 5.394531 Z M 3.671875 9.207031 C 3.707031 8.359375 4.273438 7.707031 4.921875 7.707031 C 5.582031 7.707031 6.082031 8.398438 6.039062 9.242188 C 5.996094 10.089844 5.515625 10.398438 4.855469 10.398438 C 4.207031 10.398438 3.632812 10.058594 3.671875 9.207031 Z M 10.46875 11.421875 C 10.070312 12.382812 9.121094 13.054688 8.011719 13.054688 C 6.902344 13.054688 5.953125 12.382812 5.546875 11.421875 C 5.503906 11.308594 5.578125 11.183594 5.703125 11.164062 C 6.421875 11.097656 7.195312 11.058594 8.011719 11.058594 C 8.820312 11.058594 9.59375 11.097656 10.3125 11.164062 C 10.4375 11.179688 10.519531 11.308594 10.46875 11.421875 Z M 11.160156 10.398438 C 10.503906 10.398438 10.019531 10.089844 9.976562 9.25 C 9.9375 8.398438 10.4375 7.714844 11.09375 7.714844 C 11.753906 7.714844 12.308594 8.359375 12.351562 9.207031 C 12.386719 10.058594 11.8125 10.398438 11.160156 10.398438 Z M 11.160156 10.398438',
};
