/**
 * VK service provider
 */

import { getScript, global } from '../dom';
import { makeUrl, set } from '../utils';

const vkontakte = {
    counterUrl: 'https://vk.com/share.php?act=count&url={url}&index={index}',
    counter(url, promise) {
        this.promises.push(promise);

        getScript(makeUrl(url, {
            index: this.promises.length - 1,
        }));
    },
    promises: [],
    popupUrl: 'https://vk.com/share.php?url={url}&title={title}',
    popupWidth: 550,
    popupHeight: 330,
    svgIconPath: 'M91.5385 0.881119H48.951C10.0839 0.881119 0.881119 10.0839 0.881119 48.951V91.5385C0.881119 130.406 10.0839 139.608 48.951 139.608H91.5385C130.406 139.608 139.608 130.406 139.608 91.5385V48.951C139.608 10.0839 130.308 0.881119 91.5385 0.881119ZM112.881 99.8601H102.797C98.979 99.8601 97.8042 96.8252 90.951 89.8741C84.979 84.0979 82.3357 83.3147 80.8671 83.3147C78.8112 83.3147 78.2238 83.9021 78.2238 86.7413V95.8461C78.2238 98.2937 77.4406 99.7622 70.979 99.7622C60.3077 99.7622 48.4615 93.3007 40.1399 81.2587C27.6084 63.6364 24.1818 50.4196 24.1818 47.6783C24.1818 46.2098 24.7692 44.8392 27.6084 44.8392H37.6923C40.2378 44.8392 41.2168 46.014 42.1958 48.7552C47.1888 63.1469 55.5105 75.7762 58.9371 75.7762C60.2098 75.7762 60.7972 75.1888 60.7972 71.958V57.0769C60.4056 50.2238 56.7832 49.6364 56.7832 47.1888C56.7832 46.014 57.7622 44.8392 59.3287 44.8392H75.1888C77.3427 44.8392 78.1259 46.014 78.1259 48.5594V68.6294C78.1259 70.7832 79.1049 71.5664 79.6923 71.5664C80.965 71.5664 82.042 70.7832 84.3916 68.4336C91.6364 60.3077 96.8252 47.7762 96.8252 47.7762C97.5105 46.3077 98.6853 44.9371 101.231 44.9371H111.315C114.35 44.9371 115.035 46.5035 114.35 48.6573C113.077 54.5315 100.741 71.958 100.741 71.958C99.6643 73.7203 99.2727 74.5035 100.741 76.4615C101.818 77.9301 105.343 80.965 107.692 83.7063C112 88.6014 115.329 92.7133 116.21 95.5524C117.189 98.3916 115.72 99.8601 112.881 99.8601Z',
};

set(global, 'VK.Share.count', (index, count) => {
    vkontakte.promises[index](count);
});

export default vkontakte;
